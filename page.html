<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    M.FormSelect.init(document.querySelectorAll('select'));
    M.Datepicker.init(document.querySelectorAll('.datepicker'), {
      format: 'dd/mm/yyyy',
      autoClose: true
    });
  });

  document.getElementById("btn").addEventListener("click", doStuff);
  document.getElementById("std_num").addEventListener("input", function () {
    document.getElementById("slider-value").textContent = this.value;
  });

  function doStuff() {
    const userInfo = {
      nombre: document.getElementById("nombre").value,
      apellido: document.getElementById("apellido").value,
      company: document.getElementById("company").value,
      email: document.getElementById("email").value,
      telefono: document.getElementById("telefono").value,
      hora_contacto: document.getElementById("hora_contacto").value,
      cursos: Array.from(document.getElementById("cursos").selectedOptions).map(opt => opt.value),
      fecha_inicio: document.getElementById("fecha_inicio").value,
      std_num: document.getElementById("std_num").value,
      comentarios: document.getElementById("comentarios").value,
      checkbox: document.getElementById("terms").checked
    };

    fetch("https://script.google.com/macros/s/AKfycbyRfCwFzLXWtGCK9kuAbXye362WpyAKwLcqMzkfr_fiO28io8pm9hsQFu70jU2At2IE/exec", {
      method: "POST",
      body: JSON.stringify(userInfo),
      headers: {
        "Content-Type": "application/json"
      }
    })
    .then(response => {
      if (!response.ok) throw new Error("Network response was not ok");
      return response.text();
    })
    .then(data => {
      M.toast({ html: 'Â¡Formulario enviado exitosamente!', classes: 'rounded' });
      document.querySelector("form").reset();
      document.getElementById("slider-value").textContent = "1";
      M.FormSelect.init(document.querySelectorAll('select'));
    })
    .catch(error => {
      M.toast({ html: 'Error al enviar el formulario.', classes: 'rounded red' });
      console.error("Error:", error);
    });
  }
</script>
